<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Telegram Bot Messages</title>
  <meta name="viewport" content="width=240, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; padding:10px; max-width:240px; }
    h3 { margin: 6px 0 10px 0; font-size:16px; }
    #messages {
      border:1px solid #ddd; padding:8px;
      height:260px; overflow:auto; font-size:13px;
      background:#fafafa;
    }
    .msg {
      margin:6px 0; padding:6px; border-radius:6px;
      background:#e6ffe6; text-align:left;
    }
    form { margin-top:8px; }
    input[type="text"] { width:100%; padding:6px; font-size:14px; }
    button { width:100%; padding:8px; margin-top:6px; font-size:14px; cursor:pointer; }
    small { color:#666 }
  </style>
</head>
<body>
  <h3>Bot Sent Messages</h3>
  <div id="messages">Loadingâ€¦</div>

  <form id="sendForm" onsubmit="event.preventDefault(); sendMessage();">
    <input id="text" type="text" placeholder="Type message..." required />
    <button type="submit">Send</button>
  </form>

  <p><small id="status"></small></p>

<script>
/* === Config === */
const BOT_TOKEN = "7625260219:AAHaPBpQVQ2CXL-e_RiHh8FUbXxmec5YCKc";
const CHAT_ID   = "-1002368470030";
const API_BASE  = "https://api.telegram.org/bot" + BOT_TOKEN;

let lastUpdateId = 0;

function appendMessage(text) {
  const d = document.createElement('div');
  d.className = 'msg';
  d.textContent = text;
  const msgs = document.getElementById('messages');
  msgs.appendChild(d);
  msgs.scrollTop = msgs.scrollHeight;
}

async function sendMessage() {
  const input = document.getElementById('text');
  const text = input.value.trim();
  if (!text) return;

  document.getElementById('status').textContent = "Sending...";
  try {
    const res = await fetch(API_BASE + '/sendMessage', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ chat_id: CHAT_ID, text: text })
    });
    const data = await res.json();
    if (data.ok) {
      appendMessage(text); // only show what bot sent
      input.value = '';
      document.getElementById('status').textContent = "Sent";
    } else {
      document.getElementById('status').textContent = "Error: " + data.description;
    }
  } catch (err) {
    document.getElementById('status').textContent = "Network error";
  }
}

/* Poll updates, but only show bot-sent messages */
async function pollUpdates() {
  try {
    const url = API_BASE + '/getUpdates?timeout=0' +
                (lastUpdateId ? '&offset=' + (lastUpdateId + 1) : '');
    const res = await fetch(url);
    const data = await res.json();
    if (data.ok && data.result.length) {
      data.result.forEach(upd => {
        lastUpdateId = upd.update_id;
        if (upd.message && upd.message.from && upd.message.from.is_bot) {
          appendMessage(upd.message.text);
        }
      });
    }
  } catch (e) {
    console.error(e);
  }
}

setInterval(pollUpdates, 3000);
</script>
</body>
</html>
